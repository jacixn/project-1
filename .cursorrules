# Project Intelligence (.cursorrules)

## Workflow
- Always read `memory-bank/*.md` at the start of work.
- Prefer small, safe diffs and verify files are non-empty due to prior repo corruption incidents.

## Hot Reload / Code Changes
- The user manages Metro and the simulator themselves. **NEVER kill Metro, restart the app, or run start scripts** — the user handles this in their own terminal.
- After making code changes, just tell the user what was changed. They will reload the app themselves.

## iOS Widget (CRITICAL — DO NOT DELETE)
- The app has an iOS widget: `fivefold-ios/ios/BiblelyVerseWidget/`.
- **NEVER delete, remove, or overwrite the BiblelyVerseWidget directory or any of its files** during cleanup, refactoring, cache clearing, or any other operation.
- When clearing Xcode build caches or simulator data, always preserve the widget source files.

## Navigation (CRITICAL)
- **NEVER use `LiquidGlassTabBar` or `PerfectTabBar`**. These are deprecated custom tab bar components and must NEVER be imported, referenced, or used in any way.
- The app uses the **native iOS tab bar** via `@bottom-tabs/react-navigation` (`createNativeBottomTabNavigator`) in `TabNavigator.js`. Always keep it that way.
- The Profile tab icon shows the user's profile picture via `{ uri: profilePicture }`, falling back to `{ sfSymbol: 'person.fill' }`.

## Pull-to-Refresh (CRITICAL — no native RefreshControl)
- **NEVER use `<RefreshControl>`** on the Profile tab's main ScrollView. The native iOS `UIRefreshControl` renders a visible spinner that **cannot be hidden** — even `tintColor="transparent"` doesn't work on many iOS versions.
- Instead, detect the pull gesture with `onScrollEndDrag` checking `contentOffset.y < -70`, and show a **custom absolutely-positioned indicator** (Lottie or ActivityIndicator).
- The loading animation is user-configurable in Customisation (stored in `fivefold_loading_animation` via userStorage).

## UI / UX conventions
- **Readability first**: gradients/glass are allowed only if text contrast remains strong.
- When text is over a gradient, prefer:
  - dark scrim behind the text block
  - slightly heavier font weight
  - subtle text shadow for edge clarity
- Buttons on pastel backgrounds should not rely on low-opacity white fills; use darker fills or add a scrim.

## App Copy / Wording
- **NEVER use the word "AI" in any user-facing text**. This includes buttons, labels, descriptions, disclaimers, loading states, and any other text the user can see. Instead, use natural alternatives like "smart", "personalised", "analysing", etc. The features should feel magical without calling attention to the underlying technology.

## Notifications
- **NEVER use emojis in notification titles or body text**. Keep all notifications clean and professional without any emoji characters. This applies to:
  - Prayer reminders
  - Workout reminders
  - Task reminders
  - Streak notifications
  - All other push notifications

## Bible Data
- The app has **44 Bible translations** hosted on a **private** GitHub repo (`jacixn/bible-versions`).
- Access requires a PAT stored in `fivefold-ios/github.config.js` (gitignored).
- After a fresh clone, `github.config.js` must be manually recreated — see `techContext.md` for format.
- If Bible data is ever lost, it can be re-scraped from BibleHub.com — full instructions in `techContext.md` under "Bible Data Architecture".
- Scraper scripts live at `/Users/jz/Desktop/bible-scraper/`.

## Nutrition / Fuel Feature
- Food photo analysis uses **Google Gemini Vision API** via `fivefold-ios/gemini.config.js` (gitignored).
- After a fresh clone, `gemini.config.js` must be recreated with: `export const GEMINI_CONFIG = { apiKey: '<your-key>' };`
- Get the key from https://aistudio.google.com/apikey
- Without the key, food scanning gracefully degrades to manual entry only.
- TDEE calculation uses the Mifflin-St Jeor equation.
- Nutrition data is stored locally in AsyncStorage (`@nutrition_profile`, `@food_log`, `@food_favorites`).

## OCR Service
- OCR.space API key is stored in `fivefold-ios/ocr.config.js` (gitignored).
- After a fresh clone, recreate with: `export const OCR_CONFIG = { apiKey: '<your-key>' };`
- Get a free key from https://ocr.space/ocrapi/freekey

## Legal / App Store
- Privacy Policy, Terms of Service, and Support pages are in `fivefold-ios/legal/`.
- These HTML files must be hosted (e.g. GitHub Pages) and the URLs added to App Store Connect.
- Links to these pages are in the Settings/Profile screen under "Legal".
- App Store marketing copy is in `fivefold-ios/legal/app-store-copy.md`.